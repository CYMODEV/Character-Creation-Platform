{
  "name": "cymos-platform",
  "private": true,
  "scripts": {
    "dev:api": "pnpm --filter @cymos/api dev",
    "dev:web": "pnpm --filter @cymos/web dev",
    "contracts:compile": "pnpm --filter @cymos/contracts compile"
  }
}
# pnpm-workspace.yaml
packages:
  - "apps/*"
  - "contracts"
# docker-compose.yml
version: "3.9"
services:
  db:
    image: postgres:16
    environment:
      POSTGRES_USER: cymos
      POSTGRES_PASSWORD: cymos
      POSTGRES_DB: cymos
    ports: [ "5432:5432" ]
    volumes: [ "pgdata:/var/lib/postgresql/data" ]
  api:
    build:
      context: ./apps/api
      dockerfile: Dockerfile
    environment:
      DATABASE_URL: postgres://cymos:cymos@db:5432/cymos
    ports: [ "4000:4000" ]
    depends_on: [ db ]
  web:
    build:
      context: ./apps/web
      dockerfile: Dockerfile
    environment:
      VITE_API_URL: http://localhost:4000
    ports: [ "5173:5173" ]
    depends_on: [ api ]
volumes:
  pgdata:
# .github/workflows/ci.yml
name: CI
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v4
        with: { version: 9 }
      - uses: actions/setup-node@v4
        with: { node-version: "20", cache: "pnpm" }
      - run: pnpm install --frozen-lockfile
      - run: pnpm -C apps/api prisma:generate
      - run: pnpm -C apps/api build
      - run: pnpm -C apps/web build
      - run: pnpm -C contracts compile
